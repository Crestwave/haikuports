SUMMARY="The head-to-head multiplayer ball game"
DESCRIPTION="Official continuation of the famous Blobby Volley 1.x arcade \
game.

The \"Dedicated Server\" runs with a Gamespeed of 100%, which means 75 FPS
The Port for the Server is 1234."
HOMEPAGE="http://blobby.sourceforge.net/"
COPYRIGHT="2006 Daniel Knobe
	2006 Jonathan Sieber"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="https://downloads.sourceforge.net/blobby/blobby2-linux-$portVersion.tar.gz"
CHECKSUM_SHA256="ba7a049e298aaa2014c1e1ac1faf3b0256b4c66266cd4db06e7939e8695bf5e2"
PATCHES="blobby-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 x86 x86_64"
commandBinDir=$binDir
if [ "$targetArchitecture" = x86_gcc2 ]; then
SECONDARY_ARCHITECTURES="x86"
commandBinDir=$prefix/bin
fi

PROVIDES="
	blobby$secondaryArchSuffix = $portVersion
	app:Blobby = $portVersion
	cmd:blobby_server
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libGL$secondaryArchSuffix
	lib:libphysfs$secondaryArchSuffix
	lib:libSDL2_2.0$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libboost_system$secondaryArchSuffix
	devel:libGL$secondaryArchSuffix
	devel:libphysfs$secondaryArchSuffix
	devel:libSDL2$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:cmake
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:zip
	"

defineDebugInfoPackage blobby$secondaryArchSuffix \
	"$appsDir/Blobby" \
	"$commandBinDir/blobby-server"

BUILD()
{
	cmake . $cmakeDirArgs \
		-DCMAKE_EXE_LINKER_FLAGS="-lnetwork" \
		-DCMAKE_INSTALL_BINDIR="$commandBinDir"
	make $jobArgs
}

INSTALL()
{
	make install

	install -m 755 -d "$appsDir" "$docDir" "$dataDir/blobby/server"
	mv "$commandBinDir/blobby" "$appsDir/Blobby"
	addAppDeskbarSymlink "$appsDir/Blobby" "Blobby Volley 2"

	cp -r doc/* README "$docDir"
	mv "$prefix/share/blobby/server.xml" "$dataDir/blobby/server"
	mv "$prefix/share/blobby"/* "$dataDir/blobby"
	rm -rf "$prefix/share"
}
